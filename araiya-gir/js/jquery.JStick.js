!function(t,e,o,n){"use strict";var s="JStick",i={context:e,dockBottom:!0,offsetTop:0,offsetBottom:0};function r(e,r){var c,h;this.element=e,this.settings=t.extend({},i,r),this._defaults=i,this._name=s,this.settings.parent=this.element.parentElement,this.settings.vendorTransform=(h=(c=o.createElement("div")).style.transform!=n?"transform":c.style.webkitTransform!=n?"webkitTransform":c.style.mozTransform!=n?"mozTransform":c.style.msTransform!=n&&"msTransform",c.remove(),h),this.ticking=!1,this.elGeom=this.getGeomInDocument(this.element),this.parentGeom=this.getGeomInDocument(this.settings.parent),this.dockedTop=!1,this.dockedBottom=!1,this.timer=0,this.transY=0,this.init()}t.extend(r.prototype,{init:function(){var e;console.log("init",this.settings),t(this.settings.context).on("scroll",(e=this,"onScroll",function(){return e.onScroll.apply(e,arguments)}))},getPosInViewport:function(t){return(t||this.element).getBoundingClientRect()},getGeomInDocument:function(t){var e=this.getPosInViewport(t),o=this.getScrollOffsets();return{x:e.left+o.x,y:e.top+o.y,w:e.width||e.right-e.left,h:e.height||e.bottom-e.top}},getScrollOffsets:function(t){return{x:(t=this.settings.context).pageXOffset,y:t.pageYOffset}},getViewportSize:function(t){return{w:(t=this.settings.context).innerWidth,h:t.innerHeight}},dockTop:function(){this.dockedTop=!0,t(this.element).trigger(s+":dockTop")},undockTop:function(){this.dockedTop=!1,t(this.element).trigger(s+":undockTop")},dockBottom:function(){this.dockedBottom=!0,t(this.element).trigger(s+":dockBottom")},undockBottom:function(){this.dockedBottom=!1,t(this.element).trigger(s+":undockBottom")},onScroll:function(){if(!this.ticking){var t=this;t.ticking=!0,console.log("scroll tick"),requestAnimationFrame(function(){!function t(e){e.transY=e.getScrollOffsets().y-e.elGeom.y+e.settings.offsetTop,e.getScrollOffsets().y>=e.elGeom.y-e.settings.offsetTop?e.dockedTop||e.dockTop():(e.transY=0,e.dockedTop&&e.undockTop()),e.elGeom.y+e.elGeom.h+e.transY>=e.parentGeom.y+e.parentGeom.h?(e.transY=e.parentGeom.y+e.parentGeom.h-(e.elGeom.y+e.elGeom.h),e.dockedBottom||(e.dockBottom(),console.log("new dockbottom"))):e.dockedBottom&&e.undockBottom(),e.element.style[e.settings.vendorTransform]="translateY("+e.transY+"px)",e.ticking&&requestAnimationFrame(function(){t(e)})}(t)})}clearTimeout(this.timer),this.timer=setTimeout(function(){this.ticking=!1,console.log("timeout")},300)},loop:function(){this.transY=this.getScrollOffsets().y-this.elGeom.y+this.settings.offsetTop,this.getScrollOffsets().y>=this.elGeom.y-this.settings.offsetTop?this.dockedTop||this.dockTop():(this.transY=0,this.dockedTop&&this.undockTop()),this.elGeom.y+this.elGeom.h+this.transY>=this.parentGeom.y+this.parentGeom.h?(this.transY=this.parentGeom.y+this.parentGeom.h-(this.elGeom.y+this.elGeom.h),this.dockedBottom||(this.dockBottom(),console.log("new dockbottom"))):this.dockedBottom&&this.undockBottom(),this.element.style[this.settings.vendorTransform]="translateY("+this.transY+"px)"},destroy:function(){}}),t.fn[s]=function(e){return this.each(function(){t.data(this,"plugin_"+s)||t.data(this,"plugin_"+s,new r(this,e))})}}(jQuery,window,document);